<footer class="page-footer bg-color">
    <%
    var year = new Date().getFullYear();
    var allShow = '';
    if ((theme.busuanziStatistics && theme.busuanziStatistics.enable) || (theme.socialLink && theme.socialLink.enable)){
        //console.log(allShow)
    }else{
        allShow = 'm12 l12';
    }
    %>
    <%if(theme.music.enable&&theme.music.fixed){ %>
    <%- partial('_widget/music') %>
    <% } %>
    <div class="container row center-align" style="margin-bottom: <% if (theme.time.enable) { %>15<% } else { %>10<% } %>px !important;">
        <div class="col s12 m8 l8 copy-right <%- allShow %>">
            <% if (theme.icp.enable) { %>
                 <span id="icp"><img src="<%- theme.jsDelivr.url %>/medias/icp.png" style="vertical-align: text-bottom;" />
                    <a href="<%- theme.icp.url %>" target="_blank"><%- theme.icp.text %></a>
                </span>
            <% } %>
            &nbsp;&copy;
            <span id="year"><%- theme.time.year %> – <span id="f_time"><%- year %></span></span>
            <a href="<%- config.url %>" target="_blank"><%- config.author %></a>
            |&nbsp;Powered by&nbsp;<a href="https://gitee.com/doobo/hexo-web" target="_blank">Hexo</a>
            |&nbsp;Theme&nbsp;<a href="#" target="_blank">Matery</a>
            <% if (theme.postInfo.totalCount) { %>
            <br>
            &nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span
                    class="white-color"><%= totalcount(site) %></span>&nbsp;字
            <% } %>
            <% let socialClass = '' %>
            <% if (theme.busuanziStatistics && theme.busuanziStatistics.enable) { %>
            <% socialClass = 'social-statis' %>
            <% } %>
            <% if (theme.busuanziStatistics && theme.busuanziStatistics.totalTraffic) { %>
            <span id="busuanzi_container_site_pv">
                |&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv"
                                                                        class="white-color"></span>&nbsp;次
            </span>
            <% } %>
            <% if (theme.busuanziStatistics && theme.busuanziStatistics.totalNumberOfvisitors) { %>
            <span id="busuanzi_container_site_uv">
                |&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv"
                                                                           class="white-color"></span>&nbsp;人
            </span>
            <% } %>
            <% if (theme.time.enable) { %>
            <span id="sitetime">载入运行时间...</span>
            <script>
                function siteTime() {
                    var seconds = 1000;
                    var minutes = seconds * 60;
                    var hours = minutes * 60;
                    var days = hours * 24;
                    var years = days * 365;
                    var today = new Date();
                    var startYear = "<%- theme.time.year %>";
                    var startMonth = "<%- theme.time.month %>";
                    var startDate = "<%- theme.time.date %>";
                    var startHour = "<%- theme.time.hour %>";
                    var startMinute = "<%- theme.time.minute %>";
                    var startSecond = "<%- theme.time.second %>";
                    var todayYear = today.getFullYear();
                    var todayMonth = today.getMonth() + 1;
                    var todayDate = today.getDate();
                    var todayHour = today.getHours();
                    var todayMinute = today.getMinutes();
                    var todaySecond = today.getSeconds();
                    var t1 = Date.UTC(startYear, startMonth, startDate, startHour, startMinute, startSecond);
                    var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
                    var diff = t2 - t1;
                    var diffYears = Math.floor(diff / years);
                    var diffDays = Math.floor((diff / days) - diffYears * 365);
                    var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
                    var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) /
                        minutes);
                    var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours -
                        diffMinutes * minutes) / seconds);
                    if (startYear == todayYear) {
                        document.getElementById("year").innerHTML = todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffDays + " 天 " + diffHours +
                            " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    } else {
                        document.getElementById("year").innerHTML = startYear + " - " + todayYear;
                        document.getElementById("sitetime").innerHTML = "本站已安全运行 " + diffYears + " 年 " + diffDays +
                            " 天 " + diffHours + " 小时 " + diffMinutes + " 分钟 " + diffSeconds + " 秒";
                    }
                }
                setInterval(siteTime, 1000);
            </script>
            <% } %>
            <br>
            <div class="footer-custom">
                <% if (theme.icp.enable) { %>
                <div style="width:300px;margin:0 auto;padding:5px 0;">
                    <a target="_blank" href="https://www.beian.gov.cn/portal/registerSystemInfo?recordcode=44030602003658"
                       style="display:inline-block;text-decoration:none;height:20px;line-height:20px;">
                        <img src="/images/beian.png" style="float:left;">
                        <p style="float:left;height:20px;line-height:20px;margin: 0px 0px 0px 5px; color:#ffffff;">粤公网安备 44030602003658号</p>
                    </a>
                </div>
                <% } %>
            </div>
            <% if (theme.count.enable) { %>
            <div style="display: none">
                <script type="text/javascript">
                    document.write("<script type=\"text\/javascript\" src=\"<%- theme.count.link %>\"><\/script>");
                </script>
            </div>
            <% } %>
        </div>
        <% if (!allShow) { %>
        <div class="col s12 m4 l4 social-link <%- socialClass %>"><%- partial('_partial/social-link') %></div>
        <% } %>
    </div>
</footer>

<div class="progress-bar"></div>
<script>
    setTimeout(function () {
        var year = new Date().getFullYear();
        $("#f_time").text(year)
    },100)
</script>